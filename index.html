<!DOCTYPE html>
<html lang="zh-TW"> <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate-key="pageTitle">免費資源網</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Tailwind CSS 自訂配置 (可選，但通常不需要修改預設字體，除非有特殊需求)
        // tailwind.config = {
        //     theme: {
        //         extend: {
        //             fontFamily: {
        //                 sans: ['Arial', 'sans-serif'],
        //             },
        //         }
        //     }
        // }
    </script>
    <style>
        /* 僅保留必要的全局樣式，避免與 Tailwind 衝突 */
        html {
            scroll-behavior: smooth;
        }
        body {
            min-height: 100vh; /* 確保背景漸變充滿整個視窗高度 */
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; /* 使用 Tailwind 預設字體棧 */
        }
        /* 如果 navbar.html 內部沒有使用 Tailwind class，這裡的樣式可以作為備用，但建議在 navbar.html 中直接使用 Tailwind */
        /*
        #navbar nav ul {
            list-style: none; padding: 0; margin: 0; display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem;
        }
        #navbar nav ul li a {
            text-decoration: none; color: white; font-weight: bold; padding: 0.5rem 1rem; border-radius: 0.375rem; transition: background-color 0.3s ease;
        }
        #navbar nav ul li a:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        */
    </style>
</head>
<body class="bg-gradient-to-br from-sky-300 to-cyan-500 text-white"> <header class="bg-sky-700/50 backdrop-blur-md shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <h1 class="text-3xl sm:text-4xl font-bold text-center text-white mb-2 sm:mb-0" data-translate-key="mainTitle">免費資源網</h1>
            <div id="navbar" class="text-center mt-2">
                </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="preview-container grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            <div class="preview bg-gradient-to-br from-slate-100 to-gray-200 text-gray-800 rounded-xl shadow-xl p-6 flex flex-col justify-between hover:shadow-2xl transition-shadow duration-300">
                <div>
                    <h2 class="text-2xl font-semibold mb-2" data-translate-key="previewTitleNetdisk">免費網盤</h2>
                    <p class="text-gray-600 mb-4" data-translate-key="previewDescNetdisk">這裡提供多種免費雲端儲存服務的簡要介紹。</p>
                </div>
                <a href="pan/wangpan.html" class="inline-block bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-sky-600 transition-colors duration-300 text-center" data-translate-key="viewDetails">查看詳情</a>
            </div>

            <div class="preview bg-gradient-to-br from-slate-100 to-gray-200 text-gray-800 rounded-xl shadow-xl p-6 flex flex-col justify-between hover:shadow-2xl transition-shadow duration-300">
                <div>
                    <h2 class="text-2xl font-semibold mb-2" data-translate-key="previewTitleEmail">免費電子郵箱</h2>
                    <p class="text-gray-600 mb-4" data-translate-key="previewDescEmail">提供免費的電子郵件服務，具備便捷管理功能與大容量儲存空間。</p>
                </div>
                <a href="email/you.html" class="inline-block bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-sky-600 transition-colors duration-300 text-center" data-translate-key="viewDetails">查看詳情</a>
            </div>

            <div class="preview bg-gradient-to-br from-slate-100 to-gray-200 text-gray-800 rounded-xl shadow-xl p-6 flex flex-col justify-between hover:shadow-2xl transition-shadow duration-300">
                <div>
                    <h2 class="text-2xl font-semibold mb-2" data-translate-key="previewTitleDomain">免費域名</h2>
                    <p class="text-gray-600 mb-4" data-translate-key="previewDescDomain">獲取免費的域名註冊服務，輕鬆建立您自己的網站。</p>
                </div>
                <a href="domain/yumian.html" class="inline-block bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-sky-600 transition-colors duration-300 text-center" data-translate-key="viewDetails">查看詳情</a>
            </div>

            <div class="preview bg-gradient-to-br from-slate-100 to-gray-200 text-gray-800 rounded-xl shadow-xl p-6 flex flex-col justify-between hover:shadow-2xl transition-shadow duration-300">
                <div>
                    <h2 class="text-2xl font-semibold mb-2" data-translate-key="previewTitleDeals">免費羊毛</h2>
                    <p class="text-gray-600 mb-4" data-translate-key="previewDescDeals">搜羅網路上各種免費活動與優惠，薅羊毛、拿好禮。</p>
                </div>
                <a href="sleep/yang.html" class="inline-block bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-sky-600 transition-colors duration-300 text-center" data-translate-key="viewDetails">查看詳情</a>
            </div>

            <div class="preview bg-gradient-to-br from-slate-100 to-gray-200 text-gray-800 rounded-xl shadow-xl p-6 flex flex-col justify-between hover:shadow-2xl transition-shadow duration-300">
                <div>
                    <h2 class="text-2xl font-semibold mb-2" data-translate-key="previewTitleMovies">免費電影</h2>
                    <p class="text-gray-600 mb-4" data-translate-key="previewDescMovies">免費觀看高清電影，海量資源隨時看，享受視聽盛宴。</p>
                </div>
                <a href="movie/mov.html" class="inline-block bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-sky-600 transition-colors duration-300 text-center" data-translate-key="viewDetails">查看詳情</a>
            </div>
        </div>
    </main>
    
    <footer class="py-8">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-2xl font-semibold mb-4 text-white" data-translate-key="visitorsCountTitle">訪問人數</h2>
            <div class="statcounter inline-block bg-white/20 p-2 rounded-lg shadow-md">
                <a title="Web Analytics" href="https://statcounter.com/" target="_blank">
                    <img class="statcounter" src="https://c.statcounter.com/13039053/0/8f2c3505/0/" alt="Web Analytics" data-translate-key="statCounterAlt" referrerPolicy="no-referrer-when-downgrade" style="width: 150px; height: auto;">
                </a>
            </div>
        </div>
    </footer>

    <script>
        // 翻譯字典 (繁體中文, 英文)
        const translations = {
            'zh-TW': { // 繁體中文
                pageTitle: "免費資源網",
                mainTitle: "免費資源網",
                navIndex: "首頁",
                navFreeDeals: "免費羊毛",
                navFreeNetdisk: "免費網盤",
                navFreeEmail: "免費電子郵箱",
                navFreeDomain: "免費域名",
                navFreeMovies: "免費電影",
                navNotes: "隨記",
                navTools: "小工具",
                previewTitleNetdisk: "免費網盤",
                previewDescNetdisk: "這裡提供多種免費雲端儲存服務的簡要介紹。",
                previewTitleEmail: "免費電子郵箱",
                previewDescEmail: "提供免費的電子郵件服務，具備便捷管理功能與大容量儲存空間。",
                previewTitleDomain: "免費域名",
                previewDescDomain: "獲取免費的域名註冊服務，輕鬆建立您自己的網站。",
                previewTitleDeals: "免費羊毛",
                previewDescDeals: "搜羅網路上各種免費活動與優惠，薅羊毛、拿好禮。",
                previewTitleMovies: "免費電影",
                previewDescMovies: "免費觀看高清電影，海量資源隨時看，享受視聽盛宴。",
                viewDetails: "查看詳情",
                visitorsCountTitle: "訪問人數",
                statCounterAlt: "網站分析"
            },
            'en': { // 英文
                pageTitle: "Free Resources Network",
                mainTitle: "Free Resources Network",
                navIndex: "Home",
                navFreeDeals: "Freebies & Deals",
                navFreeNetdisk: "Free Cloud Storage",
                navFreeEmail: "Free Email",
                navFreeDomain: "Free Domain",
                navFreeMovies: "Free Movies",
                navNotes: "Notes",
                navTools: "Tools",
                previewTitleNetdisk: "Free Cloud Storage",
                previewDescNetdisk: "A brief introduction to various free cloud storage services.",
                previewTitleEmail: "Free Email",
                previewDescEmail: "Provides free email services with convenient management and large storage capacity.",
                previewTitleDomain: "Free Domain",
                previewDescDomain: "Get free domain registration services and easily build your own website.",
                previewTitleDeals: "Freebies & Deals",
                previewDescDeals: "Collect various free online activities and discounts. Grab good deals.",
                previewTitleMovies: "Free Movies",
                previewDescMovies: "Watch HD movies for free, with a vast library available anytime. Enjoy the audiovisual feast.",
                viewDetails: "View Details",
                visitorsCountTitle: "Visitor Count",
                statCounterAlt: "Web Analytics"
            }
        };

        function applyTranslationsToNode(node, langKey) {
            const langTranslations = translations[langKey];
            if (!langTranslations) {
                console.warn(`Translations not found for language: ${langKey}. Defaulting.`);
                return;
            }

            if (node === document.documentElement) {
                const pageTitleElement = document.querySelector('title[data-translate-key="pageTitle"]');
                if (pageTitleElement && langTranslations.pageTitle) {
                    document.title = langTranslations.pageTitle;
                }
            }
            
            const elementsToTranslate = node.querySelectorAll('[data-translate-key]');
            elementsToTranslate.forEach(element => {
                const key = element.getAttribute('data-translate-key');
                if (element.tagName === 'TITLE' && key === 'pageTitle') return;

                if (langTranslations[key]) {
                    if (element.tagName === 'IMG' && key.toLowerCase().includes('alt')) {
                         element.alt = langTranslations[key];
                    } else {
                        element.textContent = langTranslations[key];
                    }
                } else {
                    console.warn(`Translation key '${key}' not found in language '${langKey}'.`);
                }
            });
        }

        function getBestAvailableLanguage() {
            const browserLangFull = navigator.language || navigator.userLanguage; 
            const browserLangBase = browserLangFull.split('-')[0]; 

            if (translations[browserLangFull]) return browserLangFull;
            if (translations[browserLangBase]) return browserLangBase;
            if (browserLangBase === 'zh' && translations['zh-TW']) return 'zh-TW';
            if (translations['en']) return 'en';
            return Object.keys(translations)[0] || 'en';
        }

        function setPageLanguage() {
            const langKey = getBestAvailableLanguage();
            document.documentElement.lang = langKey; 
            applyTranslationsToNode(document.documentElement, langKey); 
            window.currentLanguage = langKey; 
            console.log(`[DEBUG] Page language set to: ${langKey}`);
        }

        document.addEventListener('DOMContentLoaded', () => {
            setPageLanguage(); 

            fetch('./navbar.html')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Failed to load navbar.html, status: ${response.status}`);
                    }
                    return response.text(); 
                })
                .then(data => {
                    const navbarDiv = document.getElementById('navbar');
                    if (navbarDiv) {
                        // console.log('[DEBUG] Original navbar.html content:', data);
                        navbarDiv.innerHTML = data; 
                        
                        if (window.currentLanguage) {
                            // console.log('[DEBUG] Translating navbar with language:', window.currentLanguage);
                            applyTranslationsToNode(navbarDiv, window.currentLanguage);
                            // console.log('[DEBUG] Translated navbarDiv innerHTML:', navbarDiv.innerHTML);
                        } else {
                            console.warn('[DEBUG] window.currentLanguage not set, cannot translate navbar.');
                        }
                    } else {
                        console.error("Element with ID 'navbar' not found.");
                    }
                })
                .catch(error => {
                    console.error('Error loading navbar:', error);
                    const navbarDiv = document.getElementById('navbar');
                    if (navbarDiv) {
                        navbarDiv.innerHTML = `<p class="text-red-400">Navbar loading failed. Please try again later.</p>`;
                    }
                });

            // 隨機打開一個新頁面 (延遲 100 毫秒後執行)
            // setTimeout(randomOpenNewPage, 100); // 暫時註解掉，以專注於樣式和翻譯問題
        });

        function randomOpenNewPage() {
            // ... (randomOpenNewPage 函數內容保持不變)
            fetch('tun.txt')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`tun.txt 檔案載入失敗，狀態碼：${response.status}`);
                    }
                    return response.text();
                })
                .then(data => {
                    const urls = data.split('\n').map(url => url.trim()).filter(url => url !== '');
                    if (urls.length > 0) {
                        const randomUrl = urls[Math.floor(Math.random() * urls.length)];
                        const popupWidth = 400;
                        const popupHeight = 300;
                        const topPos = (window.innerHeight - popupHeight) / 2;
                        const leftPos = (window.innerWidth - popupWidth) / 2;
                        try {
                            const newWindow = window.open(randomUrl, '_blank', `width=${popupWidth},height=${popupHeight},top=${topPos},left=${leftPos},resizable=yes,scrollbars=yes`);
                            if (newWindow) {
                                window.focus(); 
                            } else {
                                console.warn('彈出視窗可能已被瀏覽器攔截。若要啟用，請檢查瀏覽器設定。');
                            }
                        } catch (e) {
                            console.error('打開新視窗時發生錯誤 (可能被攔截):', e);
                        }
                    } else {
                        console.warn('tun.txt 檔案中沒有可用的URL。');
                    }
                })
                .catch(error => {
                    console.error('從 tun.txt 載入 URL 時發生錯誤:', error);
                });
        }
    </script>
</body>
</html>
