<!DOCTYPE html>
<html lang="zh-TW"> <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate-key="pageTitle">免費資源網</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Tailwind CSS 自訂配置 (可選)
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Arial', 'sans-serif'], // 設定預設字體
                    },
                }
            }
        }
    </script>
    <style>
        /* 額外的全局樣式，例如平滑滾動 */
        html {
            scroll-behavior: smooth;
        }
        /* 確保背景漸變充滿整個視窗高度 */
        body {
            min-height: 100vh;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-sky-300 to-cyan-500 text-white font-sans">
    <header class="bg-sky-700/50 backdrop-blur-md shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <h1 class="text-3xl sm:text-4xl font-bold text-center text-white mb-2 sm:mb-0" data-translate-key="mainTitle">免費資源網</h1>
            <div id="navbar" class="text-center">
                </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="preview-container grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            <div class="preview bg-gradient-to-br from-slate-100 to-gray-200 text-gray-800 rounded-xl shadow-xl p-6 flex flex-col justify-between hover:shadow-2xl transition-shadow duration-300">
                <div>
                    <h2 class="text-2xl font-semibold mb-2" data-translate-key="previewTitleNetdisk">免費網盤</h2>
                    <p class="text-gray-600 mb-4" data-translate-key="previewDescNetdisk">這裡提供多種免費雲端儲存服務的簡要介紹。</p>
                </div>
                <a href="pan/wangpan.html" class="inline-block bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-sky-600 transition-colors duration-300 text-center" data-translate-key="viewDetails">查看詳情</a>
            </div>

            <div class="preview bg-gradient-to-br from-slate-100 to-gray-200 text-gray-800 rounded-xl shadow-xl p-6 flex flex-col justify-between hover:shadow-2xl transition-shadow duration-300">
                <div>
                    <h2 class="text-2xl font-semibold mb-2" data-translate-key="previewTitleEmail">免費電子郵箱</h2>
                    <p class="text-gray-600 mb-4" data-translate-key="previewDescEmail">提供免費的電子郵件服務，具備便捷管理功能與大容量儲存空間。</p>
                </div>
                <a href="email/you.html" class="inline-block bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-sky-600 transition-colors duration-300 text-center" data-translate-key="viewDetails">查看詳情</a>
            </div>

            <div class="preview bg-gradient-to-br from-slate-100 to-gray-200 text-gray-800 rounded-xl shadow-xl p-6 flex flex-col justify-between hover:shadow-2xl transition-shadow duration-300">
                <div>
                    <h2 class="text-2xl font-semibold mb-2" data-translate-key="previewTitleDomain">免費域名</h2>
                    <p class="text-gray-600 mb-4" data-translate-key="previewDescDomain">獲取免費的域名註冊服務，輕鬆建立您自己的網站。</p>
                </div>
                <a href="domain/yumian.html" class="inline-block bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-sky-600 transition-colors duration-300 text-center" data-translate-key="viewDetails">查看詳情</a>
            </div>

            <div class="preview bg-gradient-to-br from-slate-100 to-gray-200 text-gray-800 rounded-xl shadow-xl p-6 flex flex-col justify-between hover:shadow-2xl transition-shadow duration-300">
                <div>
                    <h2 class="text-2xl font-semibold mb-2" data-translate-key="previewTitleDeals">免費羊毛</h2>
                    <p class="text-gray-600 mb-4" data-translate-key="previewDescDeals">搜羅網路上各種免費活動與優惠，薅羊毛、拿好禮。</p>
                </div>
                <a href="sleep/yang.html" class="inline-block bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-sky-600 transition-colors duration-300 text-center" data-translate-key="viewDetails">查看詳情</a>
            </div>

            <div class="preview bg-gradient-to-br from-slate-100 to-gray-200 text-gray-800 rounded-xl shadow-xl p-6 flex flex-col justify-between hover:shadow-2xl transition-shadow duration-300">
                <div>
                    <h2 class="text-2xl font-semibold mb-2" data-translate-key="previewTitleMovies">免費電影</h2>
                    <p class="text-gray-600 mb-4" data-translate-key="previewDescMovies">免費觀看高清電影，海量資源隨時看，享受視聽盛宴。</p>
                </div>
                <a href="movie/mov.html" class="inline-block bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-sky-600 transition-colors duration-300 text-center" data-translate-key="viewDetails">查看詳情</a>
            </div>
        </div>
    </main>
    
    <footer class="py-8">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-2xl font-semibold mb-4 text-white" data-translate-key="visitorsCountTitle">訪問人數</h2>
            <div class="statcounter inline-block bg-white/20 p-2 rounded-lg shadow-md">
                <a title="Web Analytics" href="https://statcounter.com/" target="_blank">
                    <img class="statcounter" src="https://c.statcounter.com/13039053/0/8f2c3505/0/" alt="Web Analytics" referrerPolicy="no-referrer-when-downgrade" style="width: 150px; height: auto;">
                    </a>
            </div>
        </div>
    </footer>

    <script>
        // 翻譯字典 (繁體中文, 英文)
        const translations = {
            'zh-TW': { // 繁體中文
                pageTitle: "免費資源網",
                mainTitle: "免費資源網",
                navHome: "首頁", // 假設導覽列有這些項目
                navAbout: "關於我們",
                navServices: "服務項目",
                navContact: "聯絡我們",
                previewTitleNetdisk: "免費網盤",
                previewDescNetdisk: "這裡提供多種免費雲端儲存服務的簡要介紹。",
                previewTitleEmail: "免費電子郵箱",
                previewDescEmail: "提供免費的電子郵件服務，具備便捷管理功能與大容量儲存空間。",
                previewTitleDomain: "免費域名",
                previewDescDomain: "獲取免費的域名註冊服務，輕鬆建立您自己的網站。",
                previewTitleDeals: "免費羊毛",
                previewDescDeals: "搜羅網路上各種免費活動與優惠，薅羊毛、拿好禮。",
                previewTitleMovies: "免費電影",
                previewDescMovies: "免費觀看高清電影，海量資源隨時看，享受視聽盛宴。",
                viewDetails: "查看詳情",
                visitorsCountTitle: "訪問人數",
                statCounterAlt: "網站分析"
            },
            'en': { // 英文
                pageTitle: "Free Resources Network",
                mainTitle: "Free Resources Network",
                navHome: "Home",
                navAbout: "About Us",
                navServices: "Services",
                navContact: "Contact Us",
                previewTitleNetdisk: "Free Cloud Storage",
                previewDescNetdisk: "A brief introduction to various free cloud storage services.",
                previewTitleEmail: "Free Email",
                previewDescEmail: "Provides free email services with convenient management and large storage capacity.",
                previewTitleDomain: "Free Domain",
                previewDescDomain: "Get free domain registration services and easily build your own website.",
                previewTitleDeals: "Freebies & Deals",
                previewDescDeals: "Collect various free online activities and discounts. Grab good deals.",
                previewTitleMovies: "Free Movies",
                previewDescMovies: "Watch HD movies for free, with a vast library available anytime. Enjoy the audiovisual feast.",
                viewDetails: "View Details",
                visitorsCountTitle: "Visitor Count",
                statCounterAlt: "Web Analytics"
            }
            // 您可以在此處加入更多語言的翻譯，例如： 'ja': { ... }
        };

        /**
         * 根據提供的語言金鑰，應用翻譯到指定 DOM 節點下的所有帶有 data-translate-key 屬性的元素。
         * @param {Node} node - 要在其下查找並翻譯元素的 DOM 節點。
         * @param {string} langKey - 語言金鑰 (例如 'zh-TW', 'en')。
         */
        function applyTranslationsToNode(node, langKey) {
            const langTranslations = translations[langKey];
            if (!langTranslations) {
                console.warn(`找不到語言 ${langKey} 的翻譯。將使用預設語言。`);
                // 可以選擇一個預設語言，例如 'en' 或 'zh-TW'
                // langTranslations = translations['en'] || translations[Object.keys(translations)[0]];
                // if(!langTranslations) return; // 如果連預設語言都沒有，則不進行任何操作
                return;
            }

            // 如果節點是 document.documentElement (即整個 HTML 文檔)，則單獨處理 <title>
            if (node === document.documentElement) {
                const pageTitleElement = document.querySelector('title[data-translate-key="pageTitle"]');
                if (pageTitleElement && langTranslations.pageTitle) {
                    document.title = langTranslations.pageTitle;
                }
            }
            
            const elementsToTranslate = node.querySelectorAll('[data-translate-key]');
            elementsToTranslate.forEach(element => {
                const key = element.getAttribute('data-translate-key');
                // 跳過已經在上面單獨處理過的 <title> 元素
                if (element.tagName === 'TITLE' && key === 'pageTitle') {
                    return;
                }
                if (langTranslations[key]) {
                    // 如果是圖片且鍵名為 alt 相關，則設定 alt 屬性
                    if (element.tagName === 'IMG' && key.toLowerCase().includes('alt')) {
                         element.alt = langTranslations[key];
                    } else {
                        element.textContent = langTranslations[key];
                    }
                } else {
                    console.warn(`在語言 '${langKey}' 中找不到鍵 '${key}' 的翻譯。`);
                }
            });
        }

        /**
         * 偵測瀏覽器語言並返回最佳可用語言金鑰。
         * @returns {string} 最佳可用語言金鑰。
         */
        function getBestAvailableLanguage() {
            const browserLangFull = navigator.language || navigator.userLanguage; // 例如 "zh-TW", "en-US"
            const browserLangBase = browserLangFull.split('-')[0]; // 例如 "zh", "en"

            // 1. 嘗試完整語言代碼 (例如 "zh-TW")
            if (translations[browserLangFull]) {
                return browserLangFull;
            }
            // 2. 嘗試基礎語言代碼 (例如 "zh", "en")
            if (translations[browserLangBase]) {
                return browserLangBase;
            }
            // 3. 特別回退：如果基礎語言是中文 ('zh')，且有 'zh-TW' 翻譯，則使用 'zh-TW'
            if (browserLangBase === 'zh' && translations['zh-TW']) {
                return 'zh-TW';
            }
            // 4. 預設回退到英文 (如果 'en' 翻譯存在)
            if (translations['en']) {
                return 'en';
            }
            // 5. 最後回退到翻譯字典中的第一個語言，或者一個硬編碼的預設值 (例如 'en')
            return Object.keys(translations)[0] || 'en';
        }

        /**
         * 設定頁面語言：設定 HTML lang 屬性並應用翻譯。
         */
        function setPageLanguage() {
            const langKey = getBestAvailableLanguage();
            document.documentElement.lang = langKey; // 設定 <html lang="...">
            applyTranslationsToNode(document.documentElement, langKey); // 應用翻譯到整個文檔
            window.currentLanguage = langKey; // 儲存當前語言，供導覽列等後續操作使用
        }

        // 當 DOM 內容完全載入後執行
        document.addEventListener('DOMContentLoaded', () => {
            setPageLanguage(); // 設定初始頁面語言

            // 非同步載入導覽列 HTML 內容
            fetch('./navbar.html')
                .then(response => {
                    if (!response.ok) {
                        // 如果 HTTP 狀態碼不是 2xx，則拋出錯誤
                        throw new Error(`導覽列檔案載入失敗，狀態碼：${response.status}`);
                    }
                    return response.text(); // 將回應轉換為文字
                })
                .then(data => {
                    const navbarDiv = document.getElementById('navbar');
                    if (navbarDiv) {
                        navbarDiv.innerHTML = data; // 將載入的 HTML 注入到導覽列 div 中
                        // 對新載入的導覽列內容應用翻譯
                        if (window.currentLanguage) {
                            applyTranslationsToNode(navbarDiv, window.currentLanguage);
                        }
                    } else {
                        console.error("ID 為 'navbar' 的元素未找到。");
                    }
                })
                .catch(error => {
                    console.error('載入導覽列時發生錯誤:', error);
                    const navbarDiv = document.getElementById('navbar');
                    if (navbarDiv) {
                        // 在頁面上顯示錯誤訊息，方便用戶知道問題
                        navbarDiv.innerHTML = `<p class="text-red-400">導覽列載入失敗，請稍後再試。</p>`;
                    }
                });

            // 隨機打開一個新頁面 (延遲 100 毫秒後執行)
            // 請注意：原始碼中的註解提到 "1分鐘=60000毫秒"，但實際使用的是 100 毫秒。
            // 此處保留 100 毫秒的設定，與原始邏輯一致。
            // 重要提示：未經用戶明確互動（如點擊）而自動彈出視窗通常會被現代瀏覽器攔截。
            setTimeout(randomOpenNewPage, 100); 
        });

        /**
         * 從 'tun.txt' 檔案中讀取 URL 列表，隨機選擇一個並在新視窗中打開。
         * 保持當前頁面為焦點。
         */
        function randomOpenNewPage() {
            fetch('tun.txt')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`tun.txt 檔案載入失敗，狀態碼：${response.status}`);
                    }
                    return response.text();
                })
                .then(data => {
                    // 將讀取到的內容按換行符分割，並過濾掉空行
                    const urls = data.split('\n').map(url => url.trim()).filter(url => url !== '');
                    
                    if (urls.length > 0) {
                        const randomUrl = urls[Math.floor(Math.random() * urls.length)];
                        const popupWidth = 400;
                        const popupHeight = 300;
                        // 計算彈出視窗在螢幕中央的位置
                        const topPos = (window.innerHeight - popupHeight) / 2;
                        const leftPos = (window.innerWidth - popupWidth) / 2;
                        
                        try {
                            // 嘗試打開新視窗
                            const newWindow = window.open(randomUrl, '_blank', `width=${popupWidth},height=${popupHeight},top=${topPos},left=${leftPos},resizable=yes,scrollbars=yes`);
                            if (newWindow) {
                                window.focus(); // 嘗試將焦點保持在主視窗
                            } else {
                                // 這種情況通常發生在彈窗被瀏覽器攔截時
                                console.warn('彈出視窗可能已被瀏覽器攔截。若要啟用，請檢查瀏覽器設定。');
                            }
                        } catch (e) {
                            // 捕獲其他可能導致 window.open 失敗的錯誤
                            console.error('打開新視窗時發生錯誤 (可能被攔截):', e);
                        }
                    } else {
                        console.warn('tun.txt 檔案中沒有可用的URL。');
                    }
                })
                .catch(error => {
                    console.error('從 tun.txt 載入 URL 時發生錯誤:', error);
                });
        }
    </script>
</body>
</html>
